<!doctype html>
<html>
<head>
    <meta charset="UTF-8">
    <title>課表查詢雙視窗</title>
    <link rel=stylesheet href="./css/basic.css">
    <script type="text/javascript" src="http://code.jquery.com/jquery-latest.pack.js"></script>
    <script>
        var strUrl = decodeURIComponent(location.search);
  var getPara, ParaVal;
  var aryPara = [];
 
  if (strUrl.indexOf("?") != -1) {
    var getSearch = strUrl.split("?");
    getPara = getSearch[1].split("&");
    for (i = 0; i < getPara.length; i++) {
      ParaVal = getPara[i].split("=");
      aryPara.push(ParaVal[0]);
      aryPara[ParaVal[0]] = ParaVal[1];
    }

  }  
        
        
    $.ajax({
    url:'./ClassProcessing.xml',
    type: 'GET',
    dataType: 'xml',//資料型態可以不設定，且此型態不可是text或html
    timeout: 1000,
    error: function(xml){
        alert('讀取xml錯誤'+xml); //當xml讀取失敗
    },
    success: function(xml){
      $(xml).find("ClassList").each(function(i){  //取得xml父節點       
        var total=$(xml).find("ClassList").length;//xml的總筆數
		var classDay=$(this).children("Cday").text(); 
		var classSec=$(this).children("Csection").text(); 
        var classTeacher=$(this).children("Cteacher").text();
        var className=$(this).children("className").text();
        var Cclass=$(this).children("Cclass").text();
        var whichClass = "t";
        var whichDay = "1";
        var whichSec = "1";
        var tagEXE = 0;  
          switch(classDay){
    
                case "週一":
                 whichDay = 1;   
                
                    break;
                case "週二":      
                whichDay = 2;
                    break;
                case "週三":      
                whichDay = 3;  
                    break;
                case "週四":      
                whichDay = 4; 
                    break;
                case "週五":      
                whichDay = 5;  
                    break;
            }
            whichClass = whichClass.concat(whichDay);
            switch(classSec){
                case "第一節":
                 whichSec = 1;   
                    break;
                case "第二節":      
                whichSec = 2;  
                    break;
                case "第三節":      
               whichSec = 3;  
                    break;
                case "第四節":      
                whichSec = 4;  
                    break;
                case "第五節":      
                whichSec = 5;    
                    break;
                case "第六節":      
                whichSec = 6;    
                    break;
                case "第七節":      
                whichSec = 7;    
                    break;
                case "第八節":      
                whichSec = 8;    
                    break;
            } 
             whichClass = whichClass.concat(whichSec);
          
        if( Cclass == aryPara["class2ID"] || classTeacher == aryPara["teacher2ID"] ){
         if(tagEXE <1 && aryPara["class2ID"] != null || aryPara["teacher2ID"] != null){
                       if (aryPara["class2ID"] != null){
                        $("#twoTable ."+whichClass).append( "<span class='cname'>"+className+"</span><br><span class='tname'>"+ classTeacher  +"</span>");

                      }else if(aryPara["teacher2ID"] != null){
                      $("#twoTable ."+whichClass).append( "<span class='cname'>"+className+"</span><br><span class='tname'>"+ Cclass  +"</span>");
                          }
                   
                  }
          
          }
          if (Cclass == aryPara["classID"] || classTeacher == aryPara["teacherID"] ){
		    
              if(tagEXE <1 && aryPara["classID"] != null || aryPara["teacherID"] != null){
                      if (aryPara["classID"] != null){
                        $("#oneTable ."+whichClass).append( "<span class='cname'>"+className+"</span><br><span class='tname'>"+ classTeacher  +"</span>");

                      }else if(aryPara["teacherID"] != null){
                      $("#oneTable ."+whichClass).append( "<span class='cname'>"+className+"</span><br><span class='tname'>"+ Cclass  +"</span>");
                          }
                 
            }
              
              
          }
          
                    
                    
      })
    }
    })
    </script>
</head>
<body>

<div id="oneTable">
<table>
<tr>
    <th class="t00">節/周</th>
    <th class="t01">一</th>
    <th class="t02">二</th>
    <th class="t03">三</th>
<th class="t04">四</th>
<th class="t05">五</th>
</tr>
<tr>
    <td class="t10">1</td>
     <td class="t11"></td>
      <td class="t12"></td>
       <td class="t13"></td>
        <td class="t14"></td>
         <td class="t15"></td>
</tr>

<tr>
    <td class="t20">2</td>
     <td class="t21"></td>
      <td class="t22"></td>
       <td class="t23"></td>
        <td class="t24"></td>
         <td class="t25"></td>
</tr>
        <tr>
    <td class="t30">3</td>
     <td class="t31"></td>
      <td class="t32"></td>
       <td class="t33"></td>
        <td class="t34"></td>
         <td class="t35"></td>
</tr>
               <tr>
    <td class="t40">4</td>
     <td class="t41"></td>
      <td class="t42"></td>
       <td class="t43"></td>
        <td class="t44"></td>
         <td class="t45"></td>
</tr>
               <tr>
    <td class="t50">5</td>
     <td class="t51"></td>
      <td class="t52"></td>
       <td class="t53"></td>
        <td class="t54"></td>
         <td class="t55"></td>
</tr>
               <tr>
    <td class="t60">6</td>
     <td class="t61"></td>
      <td class="t62"></td>
       <td class="t63"></td>
        <td class="t64"></td>
         <td class="t65"></td>
</tr>
               <tr>
    <td class="t70">7</td>
     <td class="t71"></td>
      <td class="t72"></td>
       <td class="t73"></td>
        <td class="t74"></td>
         <td class="t75"></td>
</tr>
        
            
</table>

</div>
<div id="twoTable">
<table>
<tr>
    <th class="t00">節/周</th>
    <th class="t01">一</th>
    <th class="t02">二</th>
    <th class="t03">三</th>
<th class="t04">四</th>
<th class="t05">五</th>
</tr>
<tr>
    <td class="t10">1</td>
     <td class="t11"></td>
      <td class="t12"></td>
       <td class="t13"></td>
        <td class="t14"></td>
         <td class="t15"></td>
</tr>

<tr>
    <td class="t20">2</td>
     <td class="t21"></td>
      <td class="t22"></td>
       <td class="t23"></td>
        <td class="t24"></td>
         <td class="t25"></td>
</tr>
        <tr>
    <td class="t30">3</td>
     <td class="t31"></td>
      <td class="t32"></td>
       <td class="t33"></td>
        <td class="t34"></td>
         <td class="t35"></td>
</tr>
               <tr>
    <td class="t40">4</td>
     <td class="t41"></td>
      <td class="t42"></td>
       <td class="t43"></td>
        <td class="t44"></td>
         <td class="t45"></td>
</tr>
               <tr>
    <td class="t50">5</td>
     <td class="t51"></td>
      <td class="t52"></td>
       <td class="t53"></td>
        <td class="t54"></td>
         <td class="t55"></td>
</tr>
               <tr>
    <td class="t60">6</td>
     <td class="t61"></td>
      <td class="t62"></td>
       <td class="t63"></td>
        <td class="t64"></td>
         <td class="t65"></td>
</tr>
               <tr>
    <td class="t70">7</td>
     <td class="t71"></td>
      <td class="t72"></td>
       <td class="t73"></td>
        <td class="t74"></td>
         <td class="t75"></td>
</tr>
        
            
</table>
    </div>
</body>
</html>